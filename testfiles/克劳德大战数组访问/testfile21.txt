// test21 - 多维数组模拟（用一维数组）
const int ROWS = 5;
const int COLS = 6;
int matrix[30];  // 5 * 6 = 30

int get_elem(int arr[], int row, int col, int cols) {
    return arr[row * cols + col];
}

void set_elem(int arr[], int row, int col, int cols, int val) {
    arr[row * cols + col] = val;
}

void init_matrix(int arr[], int rows, int cols) {
    int i, j;
    for (i = 0; i < rows; i = i + 1) {
        for (j = 0; j < cols; j = j + 1) {
            set_elem(arr, i, j, cols, i * 10 + j);
        }
    }
}

void print_matrix(int arr[], int rows, int cols) {
    int i, j;
    for (i = 0; i < rows; i = i + 1) {
        for (j = 0; j < cols; j = j + 1) {
            printf("%d ", get_elem(arr, i, j, cols));
        }
        printf("\n");
    }
}

int sum_row(int arr[], int row, int cols) {
    int j;
    int sum = 0;
    for (j = 0; j < cols; j = j + 1) {
        sum = sum + get_elem(arr, row, j, cols);
    }
    return sum;
}

int sum_col(int arr[], int col, int rows, int cols) {
    int i;
    int sum = 0;
    for (i = 0; i < rows; i = i + 1) {
        sum = sum + get_elem(arr, i, col, cols);
    }
    return sum;
}

int main() {
    int local_matrix[20];  // 4 * 5 = 20
    int i;
    
    // 全局矩阵
    init_matrix(matrix, ROWS, COLS);
    printf("Global matrix (%d x %d):\n", ROWS, COLS);
    print_matrix(matrix, ROWS, COLS);
    
    printf("Row sums: ");
    for (i = 0; i < ROWS; i = i + 1) {
        printf("%d ", sum_row(matrix, i, COLS));
    }
    printf("\n");
    
    printf("Col sums: ");
    for (i = 0; i < COLS; i = i + 1) {
        printf("%d ", sum_col(matrix, i, ROWS, COLS));
    }
    printf("\n");
    
    // 局部矩阵
    init_matrix(local_matrix, 4, 5);
    printf("\nLocal matrix (4 x 5):\n");
    print_matrix(local_matrix, 4, 5);
    
    return 0;
}

// test3_short_circuit_extreme.sy - 极端短路求值测试
int g = 0;

int inc_g() {
    g = g + 1;
    return g;
}

int dec_g() {
    g = g - 1;
    return g;
}

int set_g(int val) {
    g = val;
    return val;
}

int main() {
    // 测试1: || 短路，右边不执行
    g = 0;
    if (1 || inc_g()) { }
    printf("Test1: g=%d\n", g);  // 预期: 0

    // 测试2: && 短路，右边不执行
    g = 0;
    if (0 && inc_g()) { }
    printf("Test2: g=%d\n", g);  // 预期: 0

    // 测试3: || 不短路，右边执行
    g = 0;
    if (0 || inc_g()) { }
    printf("Test3: g=%d\n", g);  // 预期: 1

    // 测试4: && 不短路，右边执行
    g = 0;
    if (1 && inc_g()) { }
    printf("Test4: g=%d\n", g);  // 预期: 1

    // 测试5: 复杂链式短路 a || b || c
    g = 0;
    if (0 || 0 || inc_g()) { }
    printf("Test5: g=%d\n", g);  // 预期: 1

    // 测试6: 复杂链式短路 a && b && c
    g = 0;
    if (1 && 1 && inc_g()) { }
    printf("Test6: g=%d\n", g);  // 预期: 1

    // 测试7: 混合 a && b || c，a&&b为假，c执行
    g = 0;
    if (1 && 0 || inc_g()) { }
    printf("Test7: g=%d\n", g);  // 预期: 1

    // 测试8: 混合 a || b && c，a为真，b&&c不执行
    g = 0;
    if (1 || inc_g() && dec_g()) { }
    printf("Test8: g=%d\n", g);  // 预期: 0

    // 测试9: for条件中的短路
    g = 0;
    int i;
    for (i = 0; i < 3 && inc_g() > 0; i = i + 1) { }
    printf("Test9: g=%d i=%d\n", g, i);  // 预期: g=3, i=3

    // 测试10: 短路中多次函数调用
    g = 0;
    if (inc_g() > 0 && inc_g() > 0 && inc_g() > 0) { }
    printf("Test10: g=%d\n", g);  // 预期: 3

    return 0;
}

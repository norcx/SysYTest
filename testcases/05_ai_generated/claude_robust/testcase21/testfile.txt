// test21_short_circuit_in_for.sy - for条件中的短路求值
int g = 0;

int inc_and_check(int limit) {
    g = g + 1;
    if (g <= limit) {
        return 1;
    }
    return 0;
}

int always_inc() {
    g = g + 100;
    return 1;
}

int main() {
    int i;
    
    // 测试1: for条件中 && 短路
    g = 0;
    for (i = 0; i < 3 && inc_and_check(10); i = i + 1) {
        printf("Loop1 i=%d g=%d\n", i, g);
    }
    printf("After loop1: i=%d g=%d\n", i, g);
    
    // 测试2: for条件中 || 短路，左边为真时右边不执行
    g = 0;
    for (i = 0; i < 3 || always_inc(); i = i + 1) {
        printf("Loop2 i=%d g=%d\n", i, g);
        if (i >= 2) {
            break;
        }
    }
    printf("After loop2: g=%d\n", g);  // g应该是0，因为i<3一直为真
    
    // 测试3: for条件中 || 短路，左边为假时右边执行
    g = 0;
    for (i = 10; i < 3 || inc_and_check(2); i = i + 1) {
        printf("Loop3 i=%d g=%d\n", i, g);
    }
    printf("After loop3: i=%d g=%d\n", i, g);  // inc_and_check执行3次后返回0
    
    return 0;
}
